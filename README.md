# Taro-city：山东省支付宝，爱山东
多端开发 taro3 + redux + taro-ui + Hook


## 心得
 Taro真的有很多很多坑，在构建上也遇到很多问题，这次搭建这个的前提原因是啥呢，可能闲的无聊才搭建的吧

### 原因
  公司之前做的爱山东支付包小程序太过垃圾，导致现在要重构，这个项目就轮到我了，但我这个人恰好没有了解过支付包小程序，只会写基本的用法，与其使用学习小程序，不如学习Taro（站在React一端的），现在微信，支付宝，百度，京东，字节等小程序层出不穷，故多端肯定是以后的趋势（至于为什么不用公司产品直接搭建，大家都懂~）

### Taro构建思路（问题）
  1>用户体系，这次构建的山东省统一用户体系不是针对支付宝，所以不需要支付宝的授权，而是走的统一用户平台，所以开发的登录是H5开发的多端统一获取的，那么H5和小程序交互，其实就是WebView跳转的链接，通过onMessage事件来接收所以就有了第一个问题
    Taro的WebView的onMessage方法接收不到，解决方式混合开发路由跳转是个问题（拿到token后跳转到页面执行，感觉很low）
  2>redux-persist持久化在小程序内无法使用，只能使用存储(low!!)
  3>Taro在新办中获取路由的方法getCurrentInstance()，无法在H5中获取传递的参数，小程序可以
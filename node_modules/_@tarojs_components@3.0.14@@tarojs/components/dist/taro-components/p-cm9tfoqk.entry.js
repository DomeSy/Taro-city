import{r as t,c as s,h as i,H as o,g as r}from"./p-afb5cad8.js";import{c as l}from"./p-cff38696.js";function h(t,s,i){if(t===s||"number"!=typeof t)return;const o=s-t,r=Date.now(),l=s>=t;!function h(){var c;c=Date.now()-r,t=o*c/500+t,l&&t>=s||!l&&s>=t?i(s):(i(t),requestAnimationFrame(h))}()}const c=class{constructor(i){t(this,i),this.scrollX=!1,this.scrollY=!1,this.upperThreshold=50,this.lowerThreshold=50,this.scrollWithAnimation=!1,this.handleScroll=t=>{if(t instanceof CustomEvent)return;const{scrollLeft:s,scrollTop:i,scrollHeight:o,scrollWidth:r}=this.el;this._scrollLeft=s,this._scrollTop=i,this.uperAndLower(),this.onScroll.emit({scrollLeft:s,scrollTop:i,scrollHeight:o,scrollWidth:r})},this.uperAndLower=function(t){let s;return function(...i){clearTimeout(s),s=setTimeout((function(){t(...i)}),200)}}(()=>{const{offsetWidth:t,offsetHeight:s,scrollLeft:i,scrollTop:o,scrollHeight:r,scrollWidth:l}=this.el,h=Number(this.lowerThreshold),c=Number(this.upperThreshold);!isNaN(h)&&(this.scrollY&&s+o+h>=r||this.scrollX&&t+i+h>=l)&&this.onScrollToLower.emit({direction:this.scrollX?"right":this.scrollY?"bottom":""}),!isNaN(c)&&(this.scrollY&&o<=c||this.scrollX&&i<=c)&&this.onScrollToUpper.emit({direction:this.scrollX?"left":this.scrollY?"top":""})}),this.onScroll=s(this,"scroll",7),this.onScrollToUpper=s(this,"scrolltoupper",7),this.onScrollToLower=s(this,"scrolltolower",7)}watchScrollLeft(t){const s=Number(t);this.scrollX&&!isNaN(s)&&s!==this._scrollLeft&&(this.scrollWithAnimation?h(this._scrollLeft,s,t=>this.el.scrollLeft=t):this.el.scrollLeft=s,this._scrollLeft=s)}watchScrollTop(t){const s=Number(t);this.scrollY&&!isNaN(s)&&s!==this._scrollTop&&(this.scrollWithAnimation?h(this._scrollTop,s,t=>this.el.scrollTop=t):this.el.scrollTop=s,this._scrollTop=s)}watchScrollIntoView(t){var s;"string"==typeof t&&t&&(null===(s=document.querySelector(`#${t}`))||void 0===s||s.scrollIntoView({behavior:"smooth",block:"center",inline:"start"}))}componentDidLoad(){const{scrollY:t,scrollX:s,scrollWithAnimation:i}=this,o=Number(this.mpScrollTop),r=Number(this.mpScrollLeft);t&&!isNaN(o)&&(i?h(0,o,t=>this.el.scrollTop=t):this.el.scrollTop=o,this._scrollTop=o),s&&!isNaN(r)&&(i?h(0,r,t=>this.el.scrollLeft=t):this.el.scrollLeft=r,this._scrollLeft=r)}render(){const{scrollX:t,scrollY:s}=this,r=l({"taro-scroll-view__scroll-x":t,"taro-scroll-view__scroll-y":s});return i(o,{class:r,onScroll:this.handleScroll},i("slot",null))}get el(){return r(this)}static get watchers(){return{mpScrollLeft:["watchScrollLeft"],mpScrollTop:["watchScrollTop"],mpScrollIntoView:["watchScrollIntoView"]}}static get style(){return"taro-scroll-view-core{display:block;width:100%;-webkit-overflow-scrolling:auto}taro-scroll-view-core::-webkit-scrollbar{display:none}.taro-scroll-view__scroll-x{overflow-x:scroll;overflow-y:hidden}.taro-scroll-view__scroll-y{overflow-x:hidden;overflow-y:scroll}"}};export{c as taro_scroll_view_core};
import{r as t,c as s,h as i,g as h}from"./p-afb5cad8.js";function e(t,s,i){if(!t)throw new Error("unexpected type");return"search"===s&&(t="search"),i&&(t="password"),"digit"===t&&(t="number"),t}function n(t){return null!=t?t:""}const o=class{constructor(i){t(this,i),this.isOnComposition=!1,this.onInputExcuted=!1,this.type="text",this.password=!1,this.disabled=!1,this.maxlength=140,this.autoFocus=!1,this.confirmType="done",this.hanldeInput=t=>{t.stopPropagation();const{type:s,maxlength:i,confirmType:h,password:n}=this;if(!this.isOnComposition&&!this.onInputExcuted){let o=t.target.value;const a=e(s,h,n);this.onInputExcuted=!0,"number"===a&&o&&i<=o.length&&(o=o.substring(0,i),t.target.value=o),this.onInput.emit({value:o,cursor:o.length})}},this.handleFocus=t=>{this.onInputExcuted=!1,this.onFocus.emit({value:t.target.value})},this.handleBlur=t=>{this.onBlur.emit({value:t.target.value})},this.handleChange=t=>{t.stopPropagation(),this.onChange.emit({value:t.target.value})},this.handleKeyDown=t=>{const{value:s}=t.target;this.onInputExcuted=!1,t.stopPropagation(),this.onKeyDown.emit({value:s}),13===t.keyCode&&this.onConfirm.emit({value:s})},this.handleComposition=t=>{t.target instanceof HTMLInputElement&&("compositionend"===t.type?(this.isOnComposition=!1,this.onInput.emit({value:t.target.value})):this.isOnComposition=!0)},this.onInput=s(this,"input",7),this.onFocus=s(this,"focus",7),this.onBlur=s(this,"blur",7),this.onConfirm=s(this,"confirm",7),this.onChange=s(this,"change",7),this.onKeyDown=s(this,"keydown",7)}componentDidLoad(){"file"===this.type?(this.fileListener=()=>{this.onInput.emit()},this.inputRef.addEventListener("change",this.fileListener)):(this.inputRef.addEventListener("compositionstart",this.handleComposition),this.inputRef.addEventListener("compositionend",this.handleComposition)),Object.defineProperty(this.el,"value",{get:()=>this.inputRef.value,set:t=>this.value=t,configurable:!0})}componentDidUnload(){"file"===this.type&&this.inputRef.removeEventListener("change",this.fileListener)}render(){const{value:t,type:s,password:h,placeholder:o,disabled:a,maxlength:r,autoFocus:u,confirmType:c,name:l}=this;return i("input",{ref:t=>{this.inputRef=t,u&&(null==t||t.focus())},class:"weui-input",value:n(t),type:e(s,c,h),placeholder:o,disabled:a,maxlength:r,autofocus:u,name:l,onInput:this.hanldeInput,onFocus:this.handleFocus,onBlur:this.handleBlur,onChange:this.handleChange,onKeyDown:this.handleKeyDown})}get el(){return h(this)}static get style(){return"input,taro-input-core{display:block}input{height:1.4rem;text-align:inherit;text-overflow:clip;overflow:hidden;white-space:nowrap}"}};export{o as taro_input_core};
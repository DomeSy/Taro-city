{"version":3,"file":"index.js","sources":["../src/env.ts","../src/is.ts","../src/next-tick.ts","../src/shallow-equal.ts","../src/simple-map.ts","../src/index.ts"],"sourcesContent":["// tslint:disable-next-line\nexport var global = (function() {\n  let local\n\n  if (typeof global !== 'undefined') {\n    local = global\n  } else if (typeof self !== 'undefined') {\n    local = self\n  } else {\n    try {\n      // tslint:disable-next-line:function-constructor\n      local = Function('return this')()\n    } catch (e) {\n      throw new Error('global object is unavailable in this environment')\n    }\n  }\n  return local\n})()\n\nexport const isBrowser = typeof window !== 'undefined'\n\n// tslint:disable-next-line:no-empty\nfunction noop () {}\n\nconst fakeDoc: any = {\n  createElement: noop,\n  createElementNS: noop,\n  createTextNode: noop\n}\n\nexport const doc: Document = isBrowser ? document : fakeDoc\n\nexport const UA = isBrowser && window.navigator.userAgent.toLowerCase()\n\nexport const isMacSafari = isBrowser && UA && window.navigator.platform &&\n  /mac/i.test(window.navigator.platform) && /^((?!chrome|android).)*safari/i.test(UA)\n\nexport const isTaro = isBrowser && !document.scripts\n\nexport const isIE9 = UA && UA.indexOf('msie 9.0') > 0\n\nexport const isiOS = (UA && /iphone|ipad|ipod|ios/.test(UA))\n","import { doc } from './env'\n\nexport function isNumber (arg): arg is number {\n  return typeof arg === 'number'\n}\n\nexport const isSupportSVG = isFunction(doc.createAttributeNS)\n\nexport function isString (arg): arg is string {\n  return typeof arg === 'string'\n}\n\nexport function isFunction (arg): arg is Function {\n  return typeof arg === 'function'\n}\n\nexport function isBoolean (arg): arg is true | false {\n  return arg === true || arg === false\n}\n\nexport const isArray = Array.isArray\n\nexport function isObject (arg): arg is Object {\n  return arg === Object(arg) && !isFunction(arg)\n}\nexport function isNative (Ctor) {\n  return isFunction(Ctor) && /native code/.test(Ctor.toString())\n}\n\nexport function isUndefined (o): o is undefined {\n  return o === undefined\n}\n\n// Object.is polyfill\n// https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/is\nexport function objectIs (x: any, y: any) {\n  if (x === y) { // Steps 1-5, 7-10\n    // Steps 6.b-6.e: +0 != -0\n    return x !== 0 || 1 / x === 1 / y\n  }\n  // eslint-disable-next-line no-self-compare\n  return x !== x && y !== y\n}\n","import { global, isMacSafari } from './env'\nimport { isFunction } from './is'\n\nconst canUsePromise = 'Promise' in global && !isMacSafari\n\nlet resolved\nif (canUsePromise) {\n  resolved = Promise.resolve()\n}\n\nconst nextTick: (fn, ...args) => void = (fn, ...args) => {\n  fn = isFunction(fn) ? fn.bind(null, ...args) : fn\n  if (canUsePromise) {\n    return resolved.then(fn)\n  }\n  const timerFunc = 'requestAnimationFrame' in global && !isMacSafari ? requestAnimationFrame : setTimeout\n  timerFunc(fn)\n}\n\nexport default nextTick\n","/* istanbul ignore next */\n// tslint:disable-next-line\nObject.is = Object.is || function (x, y) {\n  if (x === y) {\n    return x !== 0 || 1 / x === 1 / y\n  }\n  return x !== x && y !== y\n}\n\nexport default function shallowEqual (obj1, obj2) {\n  if (obj1 === null || obj2 === null) {\n    return false\n  }\n  if (Object.is(obj1, obj2)) {\n    return true\n  }\n  const obj1Keys = obj1 ? Object.keys(obj1) : []\n  const obj2Keys = obj2 ? Object.keys(obj2) : []\n  if (obj1Keys.length !== obj2Keys.length) {\n    return false\n  }\n\n  for (let i = 0; i < obj1Keys.length; i++) {\n    const obj1KeyItem = obj1Keys[i]\n    if (!obj2.hasOwnProperty(obj1KeyItem) || !Object.is(obj1[obj1KeyItem], obj2[obj1KeyItem])) {\n      return false\n    }\n  }\n\n  return true\n}\n","import { global } from './env'\nexport interface Cache<Key, Value> {\n  k: Key\n  v: Value\n}\n\nexport class SimpleMap<Key, Value> {\n  cache: Array<Cache<Key, Value>>\n  size: number\n  constructor () {\n    this.cache = []\n    this.size = 0\n  }\n  set (k, v) {\n    const len = this.cache.length\n    if (!len) {\n      this.cache.push({ k, v })\n      this.size += 1\n      return\n    }\n    for (let i = 0; i < len; i++) {\n      const item = this.cache[i]\n      if (item.k === k) {\n        item.v = v\n        return\n      }\n    }\n    this.cache.push({ k, v })\n    this.size += 1\n  }\n\n  get (k) {\n    const len = this.cache.length\n    if (!len) {\n      return\n    }\n    for (let i = 0; i < len; i++) {\n      const item = this.cache[i]\n      if (item.k === k) {\n        return item.v\n      }\n    }\n  }\n\n  has (k) {\n    const len = this.cache.length\n    if (!len) {\n      return false\n    }\n    for (let i = 0; i < len; i++) {\n      const item = this.cache[i]\n      if (item.k === k) {\n        return true\n      }\n    }\n    return false\n  }\n\n  delete (k) {\n    const len = this.cache.length\n    for (let i = 0; i < len; i++) {\n      const item = this.cache[i]\n      if (item.k === k) {\n        this.cache.splice(i, 1)\n        this.size -= 1\n        return true\n      }\n    }\n    return false\n  }\n\n  clear () {\n    let len = this.cache.length\n    this.size = 0\n    if (!len) {\n      return\n    }\n    while (len) {\n      this.cache.pop()\n      len--\n    }\n  }\n}\n\nexport const MapClass: MapConstructor =\n  'Map' in global ? Map : (SimpleMap as any)\n","export { default as nextTick } from './next-tick'\nexport { default as shallowEqual } from './shallow-equal'\nexport { SimpleMap, MapClass } from './simple-map'\nexport * from './is'\nexport * from './env'\n\nexport function getPrototype (obj) {\n  /* istanbul ignore next */\n  if (Object.getPrototypeOf) {\n    return Object.getPrototypeOf(obj)\n  } else if (obj.__proto__) {\n    return obj.__proto__\n  }\n  /* istanbul ignore next */\n  return obj.constructor.prototype\n}\n\nexport function isAttrAnEvent (attr: string): boolean {\n  return attr[0] === 'o' && attr[1] === 'n'\n}\n\nconst extend = ((): (<S, F>(source: S, from: F) => S | F & S) => {\n  if ('assign' in Object) {\n    return <S, F>(source: S, from: F): S | F & S => {\n      if (!from) {\n        return source\n      }\n      Object.assign(source, from)\n      return source\n    }\n  } else {\n    return <S, F>(source: S, from: F): S | F & S => {\n      if (!from) {\n        return source\n      }\n      for (const key in from) {\n        if (from.hasOwnProperty(key)) {\n          (source as any)[key] = from[key]\n        }\n      }\n      return source\n    }\n  }\n})()\n\nexport { extend }\n\nexport function clone<T> (obj: T): T | {} {\n  return extend({}, obj)\n}\n"],"names":[],"mappings":"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"}